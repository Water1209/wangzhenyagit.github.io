---
layout: post
title: 程序猿应该知道的数字
category: 软件架构
tags: 
---

遇到选择数据结构的时候，一个非常常见的场景就是，“读远多于写的时候”，比如CopyOnWrite系列的，读写锁使用场景，但是什么时候是“远多于”？其实这个并没有一个具体的，通用的数值，很多时候在两个数据结构，甚至两个技术选型的时候，只有进行测试才能判断出是否合适。

虽然上述的这种只有实测才能得到结论的场景不少，但是还是有那么一些参数，做为一个程序猿还是应该知道的。比如，CPU读取内存时间的数量级？机械磁盘与固态磁盘进行顺序读取，顺序读取的速度的数量级？还有些系统级别的数据，在设计的时候也可以作为参考，比如淘宝双十一的最高交易创建峰值32.5万笔/秒，了解了这个参数，作为一个交易平台，就没有必要来设计一个支持超过50万笔/秒的系统了，因为木有必要了。

## 系统级别 ##

2017年双11中，阿里巴巴再一次更新了记录：每秒32.5w笔的交易创建峰值、25.6w笔的支付峰值。参考（[双11备战核武器：全链路压测今年如何升级？](https://mp.weixin.qq.com/s/M7HKNm9yF2tqgwF8MT1NUg)）。

## CPU ##

## 内存 ##

memory copy，带宽通常在1GB/s级别以上。参考:[Java NIO浅析](https://tech.meituan.com/nio.html)

## IO ##

## 操作系统 ##

线程本身占用较大内存，像Java的线程栈，一般至少分配512K～1M的空间。这样就是说，如果系统内有1000个线程，那么线程自身的开销就可能有1G之多。参考:[Java NIO浅析](https://tech.meituan.com/nio.html)。过多线程的问题还有另外一个就是context switch的过车消耗的cpu过高，可能超过cpu用于执行线程的时间。

使用NIO != 高性能，当连接数<1000，并发程度不高或者局域网环境下NIO并没有显著的性能优势。参考:[Java NIO浅析](https://tech.meituan.com/nio.html)

