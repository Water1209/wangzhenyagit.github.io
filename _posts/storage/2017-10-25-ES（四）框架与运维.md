---
layout: post
title: ES（四）框架与运维
category: 存储系统
tags: es
---

是两个集群。第一个集群使用大城市分索引，不过，还有大部分小城市合并一个索引。大城市还是用类目进行routing，小城市合并的索引就使用城市进行routing 。

第二个集群，大类分得索引，比如fang、che，房屋和车辆和其他类目在一个集群上，他们使用 city+二级类目做routing。

puppet进行部署
redis + elastic 以综合提高性能

更新db的同时，提交一个文档 ID 通知4sea 进行更新，然后根据配置更新到不同集群。
数据提交到查询时，就是分析 query 并引导到不同集群。

用httpurlconnection请求的时候，会发现返回请求很耗时，一般怎么处理？
尽可能减少慢查询吧？我们很多工作就是想办法如何减少慢查询，routing和分分合合，就是这个目的。分别（索引和routing）查询和合并（索引和routing）查询，即此分合的意思。

线程池我们默认使用 fixed，使用 cached 有可能控制不好。

[elasticsearch - routing VS. indexing for query performance](https://stackoverflow.com/questions/23123203/elasticsearch-routing-vs-indexing-for-query-performance)  

[_routing field](https://www.elastic.co/guide/en/elasticsearch/reference/5.6/mapping-routing-field.html)

[](https://discuss.elastic.co/t/should-dedicated-master-nodes-and-data-nodes-be-considered-separately/75093/3)

[亿级规模的Elasticsearch优化实战](http://blog.csdn.net/opensure/article/details/47617437)
